---

# üß™ **TP2 ‚Äì Optique et mise au point industrielle**

## üéØ Objectifs p√©dagogiques

√Ä la fin du TP, l‚Äô√©tudiant est capable de :

* D√©terminer le **grandissement**, le **champ de vision** et la **taille du pixel objet**.
* Comprendre les compromis entre **ouverture**, **profondeur de champ** et **r√©solution spatiale**.
* Exp√©rimenter la **mise au point**, l‚Äô**ouverture du diaphragme** et leurs effets.
* Estimer la **fonction de transfert de modulation (FTM)** d‚Äôun syst√®me imageur de fa√ßon simple.

---

## üîß Mat√©riel

* Cam√©ra CMOS (mono ou couleur) avec objectif r√©glable.
* Mire de r√©solution ou mire imprim√©e (lignes fines, code-barres, grille).
* R√©glette gradu√©e / r√®gle microm√©trique.
* Source d‚Äô√©clairage uniforme (ring ou panneau diffus).
* PC avec Python + `numpy`, `opencv`, `matplotlib`.

---

## üïì **D√©roul√© (4h)**

| Temps       | √âtape                                    | Description                                                                                                                       |
| ----------- | ---------------------------------------- | --------------------------------------------------------------------------------------------------------------------------------- |
| 0h00 ‚Äì 0h20 | **Introduction**                         | Th√©orie rapide : mod√®le de lentille mince, grandissement, profondeur de champ, crit√®re de Rayleigh.                               |
| 0h20 ‚Äì 1h00 | **Champ de vision et grandissement**     | Mesure exp√©rimentale du champ observ√© et calcul du grandissement.                                                                 |
| 1h00 ‚Äì 2h00 | **Profondeur de champ et mise au point** | Exp√©riences avec diaphragmes diff√©rents (f/4 √† f/16). Observation de la nettet√© et calcul approximatif de la profondeur de champ. |
| 2h00 ‚Äì 3h15 | **R√©solution et FTM simplifi√©e**         | Analyse d‚Äôune mire √† barres : mesure du contraste selon la fr√©quence spatiale.                                                    |
| 3h15 ‚Äì 4h00 | **Mini-projet**                          | Mesure dimensionnelle d‚Äôune pi√®ce et justification du choix optique. Discussion sur les compromis.                                |

---

## üìÑ **Sujet √©tudiant**

### Partie 1 ‚Äî Champ de vision et grandissement

1. Placez un objet connu (r√©glette gradu√©e) dans le champ.
2. Capturez une image nette et mesurez (en pixels) la longueur visible.
3. D√©duisez le **champ de vision r√©el (FOV)** en mm.
4. Connaissant la taille du capteur (par ex. 6,4 mm de large), calculez le **grandissement** ( G = \frac{\text{taille image}}{\text{taille objet}} ).
5. En d√©duire la **taille du pixel sur l‚Äôobjet**.

üßÆ *Formules utiles :*
[
FOV_{obj} = \frac{N_{pix} \times \text{pitch capteur}}{G}
]
[
\text{pixel objet} = \frac{FOV_{obj}}{N_{pix}}
]

---

### Partie 2 ‚Äî Profondeur de champ

1. Placez une mire inclin√©e (ou un objet √† plusieurs profondeurs).
2. Capturez plusieurs images en modifiant le **diaphragme (f/)** et/ou la **mise au point**.
3. Observez la zone nette (en mm).
4. Estimez la **profondeur de champ** (DoF) et reliez-la √† l‚Äôouverture.

üßÆ *Formule approch√©e :*
[
DoF \approx \frac{2 N c (1+M)}{M^2}
]
avec
( N ) = nombre d‚Äôouverture,
( c ) = cercle de confusion ‚âà taille du pixel,
( M ) = grandissement.

---

### Partie 3 ‚Äî R√©solution et FTM simplifi√©e

1. Utilisez une mire √† barres (par ex. 1, 2, 4, 8, 16 paires de lignes/mm).
2. Capturez l‚Äôimage nette, puis extrayez un profil d‚Äôintensit√© sur les barres.
3. Mesurez le **contraste de Michelson** pour chaque fr√©quence.
4. Tracez la courbe ( C(f) ) ‚Üí approximation de la FTM du syst√®me.

---

### Partie 4 ‚Äî Application industrielle

1. Prenez une petite pi√®ce industrielle (boulon, pastille, composant).
2. Mesurez une dimension √† partir de l‚Äôimage (en pixels ‚Üí mm).
3. Comparez la mesure √† la valeur r√©elle (erreur relative).
4. Proposez une configuration optique am√©lior√©e (focale, f/, distance) pour une mesure plus pr√©cise.

---

## üíª **√âl√©ments de code / correction**

### 1Ô∏è‚É£ Mesure du champ de vision et du grandissement

```python
import cv2, numpy as np

img = cv2.imread("regle.png", cv2.IMREAD_GRAYSCALE)

# S√©lection manuelle de deux points sur la r√©glette
points = cv2.selectROIs("Image", img, showCrosshair=True)
cv2.destroyAllWindows()

# Exemple : deux points espac√©s de 10 mm sur la r√©glette
distance_mm = 10
distance_px = abs(points[0][0] - points[1][0])
pixel_size_object = distance_mm / distance_px
print(f"√âchelle : {pixel_size_object:.3f} mm/pixel")
```

---

### 2Ô∏è‚É£ Profil d‚Äôintensit√© et contraste

```python
import matplotlib.pyplot as plt

# Extraction d‚Äôun profil horizontal
y = img.shape[0] // 2
profile = img[y, :]

plt.plot(profile)
plt.title("Profil d‚Äôintensit√© horizontal")
plt.show()

Imax, Imin = np.max(profile), np.min(profile)
C = (Imax - Imin) / (Imax + Imin)
print(f"Contraste = {C:.3f}")
```

---

### 3Ô∏è‚É£ Courbe FTM simplifi√©e

```python
freqs = np.array([1, 2, 4, 8, 16])  # fr√©quences en paires de lignes/mm
contrastes = np.array([0.85, 0.70, 0.55, 0.30, 0.10])  # valeurs exp√©rimentales

plt.plot(freqs, contrastes, 'o-', label="FTM exp√©rimentale")
plt.xlabel("Fr√©quence spatiale (paires/mm)")
plt.ylabel("Contraste de Michelson")
plt.title("Approximation FTM du syst√®me")
plt.legend()
plt.show()
```

---

### 4Ô∏è‚É£ Profondeur de champ ‚Äî estimation simple

```python
N = 8          # ouverture (f/)
M = 0.2        # grandissement
c = 3.45e-3    # taille pixel en mm
DoF = 2 * N * c * (1 + M) / (M**2)
print(f"Profondeur de champ approximative : {DoF:.2f} mm")
```

---

## üß† **Questions de r√©flexion**

1. Pourquoi fermer le diaphragme augmente la profondeur de champ, mais diminue la r√©solution (diffraction) ?
2. Que se passe-t-il si le pixel objet devient plus grand que le plus petit d√©tail √† mesurer ?
3. Comment choisir la focale pour une inspection √† 100 mm de distance ?

---

## üí° **Variante / extension possible**

* Si tu veux prolonger le TP : ajout d‚Äôune partie sur la **distorsion de l‚Äôobjectif** (calibration OpenCV : `cv2.calibrateCamera`).
* Les √©tudiants pourraient comparer la distorsion d‚Äôun objectif grand-angle et d‚Äôun t√©l√©objectif.

---